🧭 1. Mục tiêu
Xây dựng hệ thống backend cho nền tảng xem phim trực tuyến, hỗ trợ:

Kiến trúc microservice
Phát phim bằng signed URL từ MinIO
Lưu lịch sử, bình luận, đề xuất
Chạy toàn bộ trên local bằng Docker Compose
Tích hợp Prometheus & Grafana để giám sát hệ thống


✅ 2. Functional Requirements
Mã	Chức năng	Ghi chú
F01	Đăng ký / đăng nhập	Qua auth-service, phát JWT
F02	Duyệt danh sách phim theo thể loại	movie-service cung cấp
F03	Xem chi tiết phim	Bao gồm trailer, diễn viên
✅ F04	Xem phim bằng Signed URL từ MinIO	streaming-service sinh signed URL
F05	Đánh dấu phim yêu thích	Qua user-service
⚠️ F06	Chỉ hỗ trợ bình luận, chưa có rating	comment-service
F07	Lưu lịch sử xem phim	history-service
F08	Gợi ý phim dựa trên hành vi	recommendation-service
F09	Admin CRUD phim, thể loại	movie-service, phân quyền qua JWT
F10	Ghi log hành vi người dùng	audit-service


🔐 3. Non-Functional Requirements
Nhóm	Yêu cầu
Bảo mật	Sử dụng JWT cho xác thực và phân quyền
Triển khai	Chạy 100% bằng Docker Compose, local only
Storage	Phim lưu bằng MinIO (S3-compatible)
Giám sát	✔️ Tích hợp Prometheus + Grafana để theo dõi CPU, request, DB...
Clean architecture	Service code tách biệt theo domain rõ ràng
Event-driven	Sử dụng Kafka cho 1 số event nội bộ (nếu có)



🧱 4. Microservices & Domain Logic
Service	Mô tả	DB / Storage
auth-service	Xác thực người dùng, phát JWT	PostgreSQL
user-service	Quản lý profile, danh sách yêu thích	PostgreSQL
movie-service	CRUD phim, thể loại, diễn viên, trailer	MongoDB
streaming-service	Sinh signed URL để phát phim từ MinIO	MinIO
history-service	Ghi nhận quá trình xem phim	PostgreSQL
comment-service	Người dùng để lại bình luận phim	PostgreSQL
recommendation-service	Gợi ý phim dựa trên hành vi	Redis
audit-service	Ghi lại hành vi user (login, xem, bình luận...)	File hoặc Elastic (tùy phase)
api-gateway	Cổng vào tập trung	Reverse proxy bằng NGINX hoặc Spring Cloud Gateway



🗂️ 5. Database & Storage Mapping
Thành phần	Loại	Công nghệ
Relational DB	PostgreSQL	auth, user, history, comment
NoSQL	MongoDB	movie metadata (poster, trailer...)
Object Storage	MinIO	video files (mp4), poster, trailer
Cache / Streaming	Redis	cho recommendation
Metrics	Prometheus	scraping service metrics
Visualization	Grafana	dashboard theo dõi hệ thống



📊 6. Monitoring Setup (Tích hợp sẵn)
Mỗi service expose metrics ở /actuator/prometheus hoặc /metrics
Prometheus cấu hình để scrape
Grafana có dashboard mặc định:
Request count, error rate
Container CPU / memory
DB query time
Streaming signed URL count



4. Bounded Contexts và Service Mapping
Bounded Context	Microservice đề xuất	Mô tả
Authentication	auth-service	Quản lý login, register, token
User Profile	user-service	Thông tin user, yêu thích
Movie Catalog	movie-service	CRUD phim, genre, diễn viên
Streaming	streaming-service	Tạo signed URL, quản lý token phát
Watch History	history-service	Ghi nhận quá trình xem
Rating & Review	rating-service	Đánh giá, comment
Recommendation	recommendation-service	Gợi ý phim cá nhân
Notification	notification-service	Gửi email/push
Audit Logging	audit-service	Ghi hành vi, phục vụ trace/debug
Admin Portal	Tạm thời không build UI	Nhưng có API riêng (role: ADMIN)